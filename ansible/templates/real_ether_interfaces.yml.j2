{% for vip in vips %}
- device: lo:{{ loop.index }}
  bootproto: static
  address: {{ vip.ip }}
  netmask: 255.255.255.255
  onboot: True
{% endfor %}
{% if vlan486_address | default(False) and vlan486_hwaddr | default(False) %}
- device: vlan486
  hwaddr: "{{ vlan486_hwaddr }}"
  cidr: "{{ vlan486_address }}/24"
  gateway: 18.4.86.1
  dns_nameservers: "{{ mit_dns_servers }}"
  dns_search: mit.edu
  bootproto: static
  onboot: True
{% endif %}
{% if vlan461_address | default(False) and vlan461_hwaddr | default(False) %}
- device: vlan461
  hwaddr: "{{ vlan461_hwaddr }}"
  cidr: "{{ vlan461_address }}/24"
  bootproto: static
  onboot: True
  route:
{% for hostname in groups['sql'] + groups['scripts-real'] %}
{% with info = hostvars[hostname] %}
{% if info['vlan486_address'] | default(False) and info['vlan461_address'] | default(False) %}
    - network: {{ info['vlan486_address'] }}
    - netmask: "255.255.255.255"
    - gateway: {{ info['vlan461_address'] }}
{% endif %}
{% endwith %}
{% endfor %}
{% endif %}
